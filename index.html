<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Galápagos • Instructivo / Guide</title>
  <meta name="description" content="Instrucciones de llegada y mapa • Arrival instructions & map" />

  <!-- Iconos / apariencia pro -->
  <link rel="icon" href="/favicon.ico?v=2">
<link rel="apple-touch-icon" href="/apple-touch-icon.png?v=2">
<meta property="og:image" content="/cover.jpg?v=2">

  <!-- Vista previa al compartir (WhatsApp, Facebook, X) -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Galápagos • Instructivo / Guide (ES/EN)">
  <meta property="og:description" content="Mapa 2D (My Maps) + Vista 3D (Google Earth), instructivo en ES/EN y música ambiental.">
  <meta property="og:image" content="/cover.jpg">
  <meta property="og:url" content="https://visitor-guidelines-baltra.netlify.app/">
  <meta name="twitter:card" content="summary_large_image">

  <style>
  /* Paleta con variables: claro vs. oscuro */
  :root{
    --bg:#f4f8f7;
    --fg:#222;
    --card:#ffffff;
    --muted:#555;
    --border:#dddddd;
    --accent:#28a58a;
    --accent-strong:#166c5b;
    --shadow:0 4px 10px rgba(0,0,0,0.10);
  }
  html[data-theme="dark"]{
    --bg:#0f1413;
    --fg:#e9f4f1;
    --card:#111a18;
    --muted:#b7c7c3;
    --border:#1c2624;
    --accent:#2ec4a3;
    --accent-strong:#1f8d79;
    --shadow:0 6px 16px rgba(0,0,0,0.40);
  }

  /* Base */
  *{box-sizing:border-box}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--fg);transition:background .2s,color .2s}
  .wrap{max-width:1000px;margin:0 auto;padding:20px}
  header{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:2px solid var(--border)}
  header h1{font-size:20px;margin:0}

  /* Controles */
  .lang button,
  .theme-btn{
    cursor:pointer;margin:0 4px;padding:6px 12px;border:none;border-radius:8px;
    background:var(--accent);color:#fff;font-weight:bold;transition:filter .15s,background .2s
  }
  .lang button.active{background:var(--accent-strong)}
  .lang button:hover,.theme-btn:hover{filter:brightness(0.95)}
  .theme-btn{font-size:14px}

  /* Tarjetas / secciones */
  .section{margin-top:20px;padding:15px;background:var(--card);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow)}
  .cta{margin-top:10px}
  .cta a{display:inline-block;margin:6px 10px 0 0;padding:8px 12px;background:var(--accent);color:#fff;text-decoration:none;border-radius:6px}
  .cta a:hover{background:var(--accent-strong)}

  /* Títulos (cambian por idioma con JS) */
  h2{margin-top:0}

  /* Leyenda e iconitos */
  .legend{margin-top:8px;display:flex;gap:10px;flex-wrap:wrap;font-size:12px;color:var(--muted);align-items:center}
  .legend .item{display:flex;align-items:center;gap:6px;background:color-mix(in oklab, var(--accent) 10%, transparent);border:1px solid var(--border);border-radius:999px;padding:4px 8px}
  .pin{width:28px;height:28px;display:flex;align-items:center;justify-content:center;border-radius:50%;color:#fff;font-size:16px;font-weight:700;box-shadow:0 1px 3px rgba(0,0,0,.25)}
  .pin-plane{background:#1e88e5} /* azul */
  .pin-ferry{background:#43a047} /* verde */
  .pin-bus{background:#f4511e}   /* naranja */
  .pin-star{background:#6d4c41}  /* marrón */

  /* Iframe y audio */
  iframe.map{width:100%;height:520px;border:0;border-radius:10px;background:var(--bg)}
  audio{width:100%}

  footer{margin-top:20px;font-size:12px;color:var(--muted);text-align:center}


/* ---- Ambient control ---- */
.ambient-card{
  display:flex; align-items:center; gap:12px; flex-wrap:wrap;
  margin-top:8px; padding:10px 12px; border-radius:12px;
  background:color-mix(in oklab, var(--accent) 8%, transparent);
  border:1px solid var(--border);
}
.ambient-toggle{
  display:flex; align-items:center; gap:10px;
  border:none; border-radius:999px; padding:8px 12px;
  background:var(--accent); color:#fff; font-weight:700; cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.15); transition:filter .15s, background .2s;
}
.ambient-toggle:hover{ filter:brightness(.95); }
.ambient-toggle .icon{ font-size:18px }
.ambient-toggle .eq{ display:inline-flex; gap:3px; margin-left:2px }
.ambient-toggle .eq i{
  width:3px; height:6px; background:#fff; border-radius:2px; opacity:.8;
  animation:none;
}
.ambient-toggle.playing{ background:var(--accent-strong); }
.ambient-toggle.playing .eq i{
  animation:ambientBars 900ms infinite ease-in-out;
}
.ambient-toggle.playing .eq i:nth-child(2){ animation-delay: .15s; }
.ambient-toggle.playing .eq i:nth-child(3){ animation-delay: .30s; }

@keyframes ambientBars{
  0%,100%{ height:6px; opacity:.7 }
  50%{ height:14px; opacity:1 }
}

#ambient-volume{
  appearance:none; width:160px; height:6px; border-radius:999px;
  background:linear-gradient(90deg, var(--accent) 0 var(--vol,18%), #cfd8d6 var(--vol,18%) 100%);
  outline:none; border:1px solid var(--border);
}
#ambient-volume::-webkit-slider-thumb{
  appearance:none; width:14px; height:14px; border-radius:50%;
  background:var(--accent-strong); border:none; box-shadow:0 0 0 2px #fff;
}
#ambient-volume::-moz-range-thumb{
  width:14px; height:14px; border-radius:50%;
  background:var(--accent-strong); border:none;
}

/* mejor contraste en oscuro */
html[data-theme="dark"] #ambient-volume{
  background:linear-gradient(90deg, var(--accent) 0 var(--vol,18%), #2a3432 var(--vol,18%) 100%);
}
    
    
    
</style>
  
</head>
<body>
  <div class="wrap">
    <header>
     <h1>
  <span data-lang="es">🦎 Galápagos • Instructivo</span>
  <span data-lang="en" style="display:none">🦎 Galápagos • Visitor Guide</span>
  <span data-lang="de" style="display:none">🦎 Galápagos • Besucherleitfaden</span>
</h1>
      <div class="lang">
        <button id="btn-es" class="active">ES 🇪🇸</button>
        <button id="btn-en">EN 🇬🇧</button>
        <button id="btn-de">DE 🇩🇪</button>
        <button id="theme-toggle" class="theme-btn" aria-label="Cambiar a modo oscuro">🌙</button>
      </div>
    </header>

    <div id="es" class="section">
      <h2>Bienvenido/a 🤝</h2>
      <p>Has llegado al Aeropuerto Ecológico Seymour en Baltra. Aquí empieza tu aventura hacia Puerto Ayora:</p>
      <ol>
        <li>🚌 Bus del aeropuerto → Canal de Itabaca (10–15 min).</li>
        <li>⛴️ Ferry → muelle de Santa Cruz (Itabaca).</li>
        <li>🚕/🚌 Taxi o bus hacia Puerto Ayora (el bus llega al Terminal El Mirador; de ahí taxi al hotel).</li>
      </ol>
      <div class="cta">
        <a href="Folleto ecológico natural verde Español.pdf" download>📄 Descargar instructivo en Español</a>
        <a href="https://earth.google.com/earth/d/1XmWnWw7mKk_bTjB9ppa90vUA_28ilYze?usp=sharing" target="_blank" rel="noopener">🌍 Vista 3D (Google Earth)</a>
      </div>
    </div>

    <div id="en" class="section" style="display:none">
      <h2>Welcome 🤝</h2>
      <p>You have arrived at Seymour Ecological Airport on Baltra Island. Here begins your journey to Puerto Ayora:</p>
      <ol>
        <li>🚌 Airport bus → Itabaca Channel (10–15 min).</li>
        <li>⛴️ Ferry → Santa Cruz pier (Itabaca).</li>
        <li>🚕/🚌 Taxi or bus to Puerto Ayora (bus stops at El Mirador Terminal; then taxi to your hotel).</li>
      </ol>
      <div class="cta">
        <a href="Folleto ecológico natural verde Inglés.pdf" download>📄 Download guide in English</a>
        <a href="https://earth.google.com/earth/d/1XmWnWw7mKk_bTjB9ppa90vUA_28ilYze?usp=sharing" target="_blank" rel="noopener">🌍 3D View (Google Earth)</a>
      </div>
    </div>
    
  <div id="de" class="section" style="display:none">
  <h2>Willkommen 🤝</h2>
  <p>Sie sind am Seymour Eco-Flughafen auf der Insel Baltra angekommen. Hier beginnt Ihre Reise nach Puerto Ayora:</p>
  <ol>
    <li>🚌 Flughafenbus → Itabaca-Kanal (10–15 Min.).</li>
    <li>⛴️ Fähre → Pier von Santa Cruz (Itabaca).</li>
    <li>🚕/🚌 Taxi oder Bus nach Puerto Ayora (der Bus hält am Terminal El Mirador; von dort Taxi zum Hotel).</li>
  </ol>
  <div class="cta">
    <a href="Folleto ecológico natural verde Aleman.pdf" download>
      📄 Anleitung auf Deutsch herunterladen
    </a>
    <a href="https://earth.google.com/earth/d/1XmWnWw7mKk_bTjB9ppa90vUA_28ilYze?usp=sharing" target="_blank" rel="noopener">
      🌍 3D-Ansicht (Google Earth)
    </a>
  </div>
</div>
    
 <div class="section">

   
   <h2>
  <span data-lang="es">🗺️ Mapa 2D</span>
  <span data-lang="en" style="display:none">🗺️ 2D Map</span>
  <span data-lang="de" style="display:none">🗺️ 2D-Karte</span>
</h2>
  <iframe
    src="https://www.google.com/maps/d/embed?mid=11Q2N6ybnaNk9ll-GL_IthtDPxddkqcY&ehbc=2E312F&noprof=1"
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade"
    allowfullscreen
    style="width:100%;height:520px;border:0;border-radius:10px;">
  </iframe>

  <div class="legend">
    <div class="item"><span class="pin pin-plane">🛫</span> Aeropuerto / Airport</div>
    <div class="item"><span class="pin pin-ferry">⛴️</span> Ferry / Canal</div>
    <div class="item"><span class="pin pin-bus">🚌</span> Terminal / Bus</div>
    <div class="item"><span class="pin pin-star">★</span> Centro / Puerto Ayora</div>
  </div>
</div>

    <div class="section">
  <h2>
    <span data-lang="es">🎶 Música ambiental</span>
    <span data-lang="en" style="display:none">🎶 Ambient music</span>
    <span data-lang="de" style="display:none">🎶 Ambient-Musik</span>
  </h2>

  <!-- Control minimal de sonido ambiental -->
  <div class="ambient-card" role="group" aria-label="Ambient music">
    <button id="ambient-toggle" class="ambient-toggle" aria-pressed="false">
      <span class="icon">🌊</span>
      <span class="label">
        <span data-lang="es">Sonido ambiental</span>
        <span data-lang="en" style="display:none">Ambient sound</span>
        <span data-lang="de" style="display:none">Ambient-Sound</span>
      </span>
      <span class="eq" aria-hidden="true"><i></i><i></i><i></i></span>
      <span class="state">
        <span data-lang="es">Activar</span>
        <span data-lang="en" style="display:none">Enable</span>
        <span data-lang="de" style="display:none">Aktivieren</span>
      </span>
    </button>

    <!-- Volumen discreto -->
    <input id="ambient-volume" type="range" min="0" max="1" step="0.01" value="0.18" aria-label="Volume">
  </div>

  <!-- Audio oculto (sin controles nativos) -->
  <audio id="bgm" preload="auto" loop playsinline muted>
    <source src="Ambient music.mp3" type="audio/mpeg">
    Tu navegador no soporta audio HTML5.
  </audio>
</div>

    <footer>
      © 2025 Galápagos Guide — Escanea el QR para abrir esta página
    </footer>
  </div>

  <script>
  // ====== Idiomas (ES/EN/DE) ======
  const esBtn = document.getElementById('btn-es');
  const enBtn = document.getElementById('btn-en');
  const deBtn = document.getElementById('btn-de');

  const es = document.getElementById('es');
  const en = document.getElementById('en');
  const de = document.getElementById('de');

  // Títulos por idioma para la pestaña del navegador
  const pageTitles = {
    es: 'Galápagos • Instructivo',
    en: 'Galápagos • Visitor Guide',
    de: 'Galápagos • Besucherleitfaden'
  };

  function setLang(lang) {
    // Secciones
    const sections = { es, en, de };
    Object.entries(sections).forEach(([k, el]) => el && (el.style.display = (k === lang) ? 'block' : 'none'));

    // Botones activos
    esBtn?.classList.toggle('active', lang === 'es');
    enBtn?.classList.toggle('active', lang === 'en');
    deBtn?.classList.toggle('active', lang === 'de');

    // Todos los textos con data-lang (h1 y títulos de secciones)
    document.querySelectorAll('[data-lang]').forEach(el => {
      el.style.display = (el.dataset.lang === lang) ? 'inline' : 'none';
    });

    // Título de la pestaña (browser tab)
    document.title = pageTitles[lang] || pageTitles.es;

     // actualizar texto del botón de sonido según idioma
    window.updateAmbientLang?.(lang);

    try { localStorage.setItem('lang', lang); } catch(e) {}
  }

  esBtn?.addEventListener('click', () => setLang('es'));
  enBtn?.addEventListener('click', () => setLang('en'));
  deBtn?.addEventListener('click', () => setLang('de'));

  const savedLang = (typeof localStorage !== 'undefined' && localStorage.getItem('lang')) || 'es';
  setLang(savedLang);

  // ====== Tema (claro/oscuro) ======
  const toggle = document.getElementById('theme-toggle');

  function setTheme(theme){
    document.documentElement.setAttribute('data-theme', theme);
    if (toggle){
      const dark = theme === 'dark';
      toggle.textContent = dark ? '☀️' : '🌙';
      toggle.setAttribute('aria-label', dark ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
      toggle.setAttribute('aria-pressed', String(dark));
    }
    try { localStorage.setItem('theme', theme); } catch(e) {}
  }

  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  const initialTheme = (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) || (prefersDark ? 'dark' : 'light');
  setTheme(initialTheme);

  toggle?.addEventListener('click', () => {
    const current = document.documentElement.getAttribute('data-theme') || 'light';
    setTheme(current === 'dark' ? 'light' : 'dark');
  });

  try {
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
      if (!localStorage.getItem('theme')) setTheme(e.matches ? 'dark' : 'light');
    });
  } catch(e) {}
</script>

  <script>
(function(){
  const audio = document.getElementById('bgm');
  const btn   = document.getElementById('ambient-toggle');
  const volEl = document.getElementById('ambient-volume');
  if(!audio || !btn || !volEl) return;

  // ===== Estado & utilidades =====
  let playing = false;
  let fadeId  = null; // para cancelar fades en curso

  function clamp(x,a,b){ return Math.max(a, Math.min(b, x)); }
  function stopFade(){ if (fadeId){ cancelAnimationFrame(fadeId); fadeId = null; } }

  function fadeTo(target, ms, done){
    stopFade();
    const start = performance.now();
    const from  = audio.volume;
    const to    = clamp(target,0,1);
    function step(t){
      const p = Math.min(1, (t - start) / ms);
      audio.volume = from + (to - from) * p;
      if (p < 1) {
        fadeId = requestAnimationFrame(step);
      } else {
        fadeId = null;
        done && done();
      }
    }
    fadeId = requestAnimationFrame(step);
  }

  function setVolTrack(){
    const pct = Math.round(clamp(parseFloat(volEl.value)||0,0,1) * 100);
    volEl.style.setProperty('--vol', pct + '%');
  }

  function setStateLabel(mode, lang){
    const map = {
      on:  { es:'Detener', en:'Disable', de:'Stoppen' },
      off: { es:'Activar', en:'Enable',  de:'Aktivieren' }
    };
    const l = lang || localStorage.getItem('lang') || 'es';
    const el = btn.querySelector('.state span[data-lang="'+l+'"]') || btn.querySelector('.state span');
    if(el){ el.textContent = (map[mode] && map[mode][l]) || (mode==='on'?'Detener':'Activar'); }
  }

  // Lo usa setLang(...) para refrescar el texto según idioma
  window.updateAmbientLang = (lang) => setStateLabel(playing ? 'on' : 'off', lang);

  // ===== Estado inicial =====
  const savedVol = parseFloat(localStorage.getItem('ambientVol') || '0.18');
  volEl.value = isFinite(savedVol) ? savedVol : 0.18;
  audio.volume = 0.0;               // arrancamos en 0 para hacer fade-in
  setVolTrack();

  document.addEventListener('DOMContentLoaded', async () => {
    try { await audio.play(); } catch(_) {} // autoplay silencioso
    if (localStorage.getItem('ambientOn') === '1'){
      enableSound(true); // si quedó activo la última vez, arranca sonando
    } else {
      setStateLabel('off');
    }
    // asegurar que el texto del botón coincida con el idioma guardado
    window.updateAmbientLang?.(localStorage.getItem('lang') || 'es');
  });

  // ===== Interacciones =====
  // Botón toggle
  btn.addEventListener('click', () => {
    if (playing) disableSound();
    else enableSound();
  });

  // Volumen: NO reactiva si está desactivado
  volEl.addEventListener('input', () => {
    const v = clamp(parseFloat(volEl.value)||0, 0, 1);
    localStorage.setItem('ambientVol', String(v));
    setVolTrack();
    if (playing) audio.volume = v;
  });

  // Primer gesto global: solo auto-activa si el usuario NO la apagó
  const gesture = () => {
    if (!playing && localStorage.getItem('ambientOn') !== '0'){
      enableSound();
    }
    window.removeEventListener('click', gesture);
    window.removeEventListener('keydown', gesture);
    window.removeEventListener('touchstart', gesture);
  };
  window.addEventListener('click', gesture, {passive:true});
  window.addEventListener('keydown', gesture, {passive:true});
  window.addEventListener('touchstart', gesture, {passive:true});

  // ===== Helpers de control =====
  function enableSound(skipFade=false){
    stopFade();

    const target = clamp(parseFloat(volEl.value)||0.18, 0, 1);

    // Dejar el audio en estado AUDIBLE antes de reproducir
    audio.muted  = false;
    audio.volume = skipFade ? target : Math.min(0.001, target); // >0 para que el fade arranque

    // Marcar UI antes (para evitar estados raros si play() tarda)
    btn.classList.add('playing');
    btn.setAttribute('aria-pressed','true');
    playing = true;
    setStateLabel('on');
    localStorage.setItem('ambientOn','1');

    // Reproducir SIEMPRE al activar; luego hacemos fade si toca
    audio.play().then(() => {
      if (!skipFade) fadeTo(target, 700);
    }).catch(() => {
      // si por alguna razón falla, mantenemos el estado y el usuario puede reintentar
    });
  }

  function disableSound(){
    stopFade();
    // Baja a cero y pausa; queda desactivado hasta que el botón lo reactive
    fadeTo(0.0, 250, () => { try{ audio.pause(); }catch(e){} });
    audio.muted = true;

    btn.classList.remove('playing');
    btn.setAttribute('aria-pressed','false');
    playing = false;
    setStateLabel('off');
    localStorage.setItem('ambientOn','0');
  }
})();
</script>
  
</body>
</html>
